# A json schema definition of the storage fetched from the data store.
# See https://json-schema.org/

"$schema": "https://json-schema.org/draft-07/schema"

description: Entry data fetched from the data store.
type: object
required:
  - version
  - commit-version
  - activity
  - gateway-templates
  - service-templates
properties:
  version:
    description: Version of this document's schema.  The value must be the string value "v1".
    const: "v1"

  commit-version:
    description: Opaque ID for the commit version.  Allows for atomic commits on multiple data storage types.
    type: string

  activity:
    description: The activity associated with the entries.  Must be "template".
    const: "template"

  gateway-templates:
    description: Template values fetched.
    type: array
    items:
      type: object
      required:
        - namespace
        - protection
        - purpose
        - template
      properties:
        namespace:
          description: Namespace of this template, or `null` if this is the default gateway template.
          type: ["string", "null"]
        protection:
          description: Protection for this namespace. `null` means default protection level.
          type: ["string", "null"]
        purpose:
          description: >
            The purpose of this template, which is usually the destination file name,
            such as "cds.yaml" or "lds.yaml".  Multiple of these can be provided per namespace.
          type: string
        template:
          description: The template text.
          type: string

  service-templates:
    description: Template values fetched.
    type: array
    items:
      type: object
      required:
        - namespace
        - service
        - color
        - purpose
        - template
      properties:
        namespace:
          description: Namespace of this template, or `null` if this is the default gateway template.
          type: ["string", "null"]
        service:
          description: Service of this template, or `null` if this is the default service template.
          type: ["string", "null"]
        color:
          description: >
            Color of this template, or `null` if this is the default service color template.  Note that
            if `service` is "null", then this must also be "null".
          type: ["string", "null"]
        purpose:
          description: >
            The purpose of this template, which is usually the destination file name,
            such as "cds.yaml" or "lds.yaml".  Multiple of these can be provided per namespace.
          type: string
        template:
          description: The template text.
          type: string
